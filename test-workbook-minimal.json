{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "logAnalyticsWorkspaceName": {
            "type": "string",
            "defaultValue": "test-law-workbook",
            "metadata": {
                "description": "Name of the Log Analytics workspace"
            }
        }
    },
    "variables": {
        "workbookName": "[guid(resourceGroup().id, 'avd-storage-workbook')]",
        "location": "[resourceGroup().location]"
    },
    "resources": [
        {
            "type": "Microsoft.OperationalInsights/workspaces",
            "apiVersion": "2022-10-01",
            "name": "[parameters('logAnalyticsWorkspaceName')]",
            "location": "[variables('location')]",
            "properties": {
                "sku": {
                    "name": "PerGB2018"
                },
                "retentionInDays": 90
            }
        },
        {
            "type": "Microsoft.Insights/workbooks",
            "apiVersion": "2022-04-01",
            "name": "[variables('workbookName')]",
            "location": "[variables('location')]",
            "dependsOn": [
                "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))]"
            ],
            "kind": "shared",
            "properties": {
                "displayName": "AVD Storage Analytics & ANF Planning",
                "description": "Comprehensive analysis of AVD storage performance, user patterns, and Azure NetApp Files sizing recommendations",
                "category": "Azure Virtual Desktop",
                "sourceId": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))]",
                "serializedData": "{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"# AVD Storage Analytics & ANF Planning\\r\\n## Comprehensive analysis of AVD storage performance, user patterns, and Azure NetApp Files sizing recommendations\\r\\n\\r\\n### ðŸ“Š This workbook provides:\\r\\n- **Real-time Storage Performance Analysis** - IOPS, throughput, latency metrics\\r\\n- **User Session Patterns** - Peak usage times, concurrent users, session duration\\r\\n- **Profile Analytics** - FSLogix container sizes, growth trends, performance\\r\\n- **ANF Sizing Recommendations** - Performance tier suggestions based on actual usage\\r\\n- **Cost Optimization Insights** - Right-sizing recommendations and cost projections\\r\\n\\r\\n---\"},\"name\":\"Title\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"timeRange\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"label\":\"Time Range\",\"type\":4,\"description\":\"Select the time range for analysis\",\"isRequired\":true,\"value\":{\"durationMs\":604800000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":3600000,\"displayName\":\"Last 1 hour\"},{\"durationMs\":86400000,\"displayName\":\"Last 24 hours\"},{\"durationMs\":604800000,\"displayName\":\"Last 7 days\"},{\"durationMs\":2592000000,\"displayName\":\"Last 30 days\"}]}}]},\"name\":\"Parameters\"},{\"type\":1,\"content\":{\"json\":\"## ðŸ“ˆ Test Section\\r\\n\\r\\nThis is a simplified test workbook to validate deployment.\"},\"name\":\"TestSection\"}],\"styleSettings\":{\"spacingStyle\":\"narrow\"},\"$schema\":\"https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json\"}"
            }
        }
    ],
    "outputs": {
        "workbookId": {
            "type": "string",
            "value": "[resourceId('Microsoft.Insights/workbooks', variables('workbookName'))]"
        },
        "logAnalyticsWorkspaceId": {
            "type": "string",
            "value": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))]"
        }
    }
}
